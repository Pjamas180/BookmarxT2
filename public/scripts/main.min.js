function loadTemplate(e,t){templatesCache[e]?displayTemplate(templatesCache[e],t):$.get("/views/"+e+".ejs",function(o){templatesCache[e]=o,displayTemplate(o,t)})}function displayTemplate(e,t){var o=ejs.render(e,t);document.getElementById("display").innerHTML=o}function loadList(){var e=getUrlParameter("sort"),t=getUrlParameter("order"),o=getUrlParameter("tag"),n=getUrlParameter("search"),r="";e&&(r="?sort="+e+"&order="+t),n&&(r="?search="+n),o&&(r="?tag="+o),$.get("/api/bookmarks/"+r,function(e){loadTemplate("assignment2",{books:e})})}function getCSV(){console.log("clicked"),$.get("/api/bookmarks/",function(e){var t=JSON2CSV(e);console.log(t),window.open("data:text/csv;charset=utf-8,"+escape(t))})}function JSON2CSV(e){var t="object"!=typeof e?JSON.parse(e):e,o="",n="";console.log("my object: "+e),console.log(t);for(var r=0;r<t.length;r++){var n="",a=0;for(var l in t[r]){if(4==a){var d=t[r][l];d=d.replaceAll(",","&"),n+=d+","}else n+=t[r][l]+",";a+=1}a=0,n=n.slice(0,-1),o+=n+"\r\n"}return o}function handleFiles(e){console.log("files: "+e);var t=e[0];getAsText(t)}function getAsText(e){var t=new FileReader;t.readAsText(e),t.onload=loadHandler,t.onerror=errorHandler}function loadHandler(e){var t=e.target.result;processData(t)}function processData(e){for(var t=e.split(/\r\n|\n/),o=[],n=0;n<t.length;n++){for(var r=t[n].split(";"),a=[],l=0;l<r.length;l++)a.push(r[l]);o.push(a)}console.log(o);for(var n=0;n<o.length;n++){console.log("This is my: "+n+" time");for(var d in o[n])for(var i=o[n][d],s=i.split(","),l=0;l<s.length;l+=8)console.log("keywords: "+s[l+3]),$.ajax({url:"/api/bookmarks/",data:"title="+s[l+2]+"&url="+s[l+8]+"&keywords="+s[l+4].replaceAll("&",",")+"&description="+s[l+3]+"&star="+s[l+7],type:"POST",success:function(e){loadList()}})}}function errorHandler(e){"NotReadableError"==e.target.error.name&&alert("Canno't read file !")}function confirmDelete(e){var t=document.getElementById("title"+e).innerHTML,o=document.getElementById("url"+e).innerHTML,n=document.getElementById("keywords"+e).innerHTML,r={id:e,title:t,url:o,tags:n};loadTemplate("delete",{book:r})}function deleteBook(e){$.ajax({url:"/api/bookmarks/"+e,type:"DELETE",success:function(e){loadList()}})}function showAdd(){loadTemplate("add")}function addBook(){var e=document.getElementById("title"),t=document.getElementById("url"),o=document.getElementById("keywords"),n=document.getElementById("description"),r=document.getElementById("star");$.ajax({url:"/api/bookmarks/",data:"title="+e.value+"&url="+t.value+"&keywords="+o.value+"&description="+n.value+"&star="+r.value,type:"POST",success:function(e){loadList()}})}function showEdit(e){var t=document.getElementById("title"+e).innerHTML,o=document.getElementById("keywords"+e).innerHTML,n=document.getElementById("description"+e).innerHTML,r=document.getElementById("star"+e).innerHTML,a=document.getElementById("url"+e).innerHTML,l="",d="";console.log(o),"1"==r?l="selected":d="selected";var i={id:e,title:t,url:a,description:n,keywords:o,yes:l,star:r,no:d};loadTemplate("edit",{book:i})}function updateBook(e){var t=document.getElementById("edittitle"+e).value,o=document.getElementById("editstar"+e).value;console.log(o);var n=document.getElementById("editdescription"+e).value,r=document.getElementById("editkeywords"+e).value,a=document.getElementById("editurl"+e).value,t=document.getElementById("edittitle"+e).value;$.ajax({url:"/api/bookmarks/"+e,data:"title="+t+"&url="+a+"&keywords="+r+"&description="+n+"&star="+o,type:"PUT",success:function(e){loadList()}})}document.addEventListener("DOMContentLoaded",function(e){loadList()});var templatesCache=[],getUrlParameter=function(e){var t,o,n=decodeURIComponent(window.location.search.substring(1)),r=n.split("&");for(o=0;o<r.length;o++)if(t=r[o].split("="),t[0]===e)return void 0===t[1]?!0:t[1]};String.prototype.replaceAll=function(e,t,o){return this.replace(new RegExp(e.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),o?"gi":"g"),"string"==typeof t?t.replace(/\$/g,"$$$$"):t)};